var db = require('../sequelize.js');
var Sequelize = require('sequelize');

var Transaction = db.define('transactions', {
  id: {
    type: Sequelize.BIGINT,
    autoIncrement: true,
    primaryKey: true
  },
  account:          Sequelize.BLOB,
  destination:      Sequelize.BLOB,
  fee:              Sequelize.BIGINT,
  flags:            Sequelize.BIGINT,
  paths:            Sequelize.BLOB,
  send_max:         Sequelize.BIGINT,
  offer_sequence:   Sequelize.BIGINT,
  sequence:         Sequelize.BIGINT,
  signing_pub_key:  Sequelize.BLOB,
  taker_gets:       Sequelize.BLOB,
  taker_pays:       Sequelize.BLOB,
  transaction_type: Sequelize.ENUM('Payment', 'OfferCreate', 'OfferCancel',
                                   'AccountSet', 'SetRegularKey', 'TrustSet'),
  txn_signature:    Sequelize.BLOB,
  hash:             Sequelize.BLOB,
  meta_data:        Sequelize.BLOB
}, {
  timestamps: false,
  underscored: true,

  classMethods: {
    createFromJSON: function(json, t, fn) {
      Transaction.create({
        account: json.Account,
        destination: json.Destination,
        fee: json.Fee,
        flags: json.Flags,
        paths: JSON.stringify(json.Paths),
        send_max: JSON.stringify(json.SendMax),
        offer_sequence: json.OfferSequence,
        sequence: json.Sequence,
        signing_pub_key: json.SigningPubKey,
        taker_gets: JSON.stringify(json.TakerGets),
        taker_pays: JSON.stringify(json.TakerPays),
        transaction_type: json.TransactionType,
        txn_signature: json.TxnSignature,
        hash: json.hash,
        meta_data: JSON.stringify(json.metaData)
      }, { transaction: t }).complete(fn);
    }
  }
});

module.exports = Transaction;


/*
  Account: 'rHsZHqa5oMQNL5hFm4kfLd47aEMYjPstpg',
  Fee: '64',
  Flags: 0,
  OfferSequence: 2692963,
  Sequence: 2692970,
  SigningPubKey: '025718736160FA6632F48EA4354A35AB0340F8D7DC7083799B9C57C3E937D71851',
  TransactionType: 'OfferCancel',
  TxnSignature: '3045022100BAA60A6710E09540399760D7A085DAD10D1708633D3A97557ABD6A1811687B76022003D04EF4CDE0616C6AAA1C8BCE63479D4DAA6A6D54EA9BA6DDB21198DE93FE3C',
  hash: '2CA62E0A7B7F788B3765C34F573D3C63DEA8A1C09D9BD6D69997EC0D19F07B41',
  metaData: [Object] },

{ Account: 'r4D1cbep318dWtXcwJe9TjJ5Ft6Ew5NmJX',
  Fee: '10',
  Flags: 2147483648,
  Sequence: 372531,
  SigningPubKey: '03029FEEEBD211AFD0212DEA75CC667F99A3042AA531FB23733650E1C267234A18',
  TakerGets: [Object],
  TakerPays: [Object],
  TransactionType: 'OfferCreate',
  TxnSignature: '3045022100FE8B04B2E2C777B0E47BC5EF62FCDEAE820B4F30B4BA772588407034F578B3F502204237D12011F826649D99B694133BCA8F7DA857251AEB57776A4D80CF6341181A',
  hash: 'B4417A65AD4048B9AE4E0B357205AC38AD944DB29B85FD3E331240D9E0511574',
  metaData: [Object] },

{ Account: 'rEffi4EbXaUhYhiXshWNFXgJrfwVKAQavB',
  Fee: '10',
  Flags: 0,
  Sequence: 23690,
  SigningPubKey: '039885BB4F717763991717AC09F05D796B079039B19D610BA6C4C0BB9207E90E97',
  TransactionType: 'AccountSet',
  TxnSignature: '304502210099D3ECDBB4443A47CEADB32C885B2A48D52D26825916CD8D8FAF35A8D67C1F48022070BB438CF13C001E481D4863B44A457F700A7F9C9CEB72B76823F76F57D40E63',
  hash: 'AA82AEA008ACCF40AFF28278F09D2E9A5F5B07DB4BC065BF2010F99C1282DBBC',
  metaData: [Object] },

{ Account: 'r4BV3UiUNa2WjRk6xC5QVSfGbMKwZhZfVA',
  Amount: [Object],
  Destination: 'rBKtq3BucD62HqBQQxMjLSrQBYDTJSF6KB',
  Fee: '10',
  Flags: 2147483648,
  Paths: [Object],
  SendMax: [Object],
  Sequence: 27590,
  SigningPubKey: '03F19F7D17E0134268B3298697AE4D563393A2961E07907F70031A994273A61C50',
  TransactionType: 'Payment',
  TxnSignature: '304402207D26C510E8058DB7FD6A56CA1F9960BD9935800097D7EB397AC128E99B331F51022049E2E143A5966771CCBBEF903CDC89023F11504B08AD921ED9D8B732868DA226',
  hash: 'F955AD668C81C672854D21DBC5B7D918D38C5E04BBA1DE71975335343B3AE67E',
  metaData: [Object] }

{ Account: 'r4BV3UiUNa2WjRk6xC5QVSfGbMKwZhZfVA',
  Amount: [Object],
  Destination: 'rBKtq3BucD62HqBQQxMjLSrQBYDTJSF6KB',
  Fee: '10',
  Flags: 2147483648,
  Paths: [Object],
  SendMax: [Object],
  Sequence: 27589,
  SigningPubKey: '03F19F7D17E0134268B3298697AE4D563393A2961E07907F70031A994273A61C50',
  TransactionType: 'Payment',
  TxnSignature: '304402201A3C73D308458EC3B3C3BBA27C3E867CE0BD84E8C09CCEC756932E3338426AE8022042DB67D7921E0248BD64254CAA9586F80C7482A74DF0F39531F4FE44AC39171E',
  hash: '65A5690F37D77ABEAF5249EEFA6171338634BC86991616395E52BD967CA49207',
  metaData: [Object] },

{ Account: 'r4BV3UiUNa2WjRk6xC5QVSfGbMKwZhZfVA',
  Amount: [Object],
  Destination: 'rBKtq3BucD62HqBQQxMjLSrQBYDTJSF6KB',
  Fee: '10',
  Flags: 2147483648,
  Paths: [Object],
  SendMax: [Object],
  Sequence: 27588,
  SigningPubKey: '03F19F7D17E0134268B3298697AE4D563393A2961E07907F70031A994273A61C50',
  TransactionType: 'Payment',
  TxnSignature: '30450221008B7D2CDE635D11E4F410A42E45B177394B42D6E0F14BA7FACC46ED896F1A7AA8022002AFDB21F03355D4D1D79DD16CCA35528B9A9E7DC8D7998C33167353107DE891',
  hash: 'A7F3B357334A2926F834043975CDE8D2F3E1AE8FC82BB5988BF8EE777A2E879B',
  metaData: [Object] },

{ Account: 'rf9q1WE2Kdmv9AWtesCaANJyNxnFjp5T7z',
  Amount: '10000000',
  Destination: 'rf9q1WE2Kdmv9AWtesCaANJyNxnFjp5T7z',
  Fee: '15',
  Flags: 0,
  Paths: [Object],
  SendMax: [Object],
  Sequence: 21460,
  SigningPubKey: '02536B8C6323A2A079A785E85FAFE087F46499C7ADEF2E211B332BF377629F3042',
  TransactionType: 'Payment',
  TxnSignature: '30450220575363FA18D50C8F40D85E527BFAC64A653D3751E1A946C248E2323431853B32022100D9C7BE644B9A32D92AB06FEBBDEB186FFEDD13A2DC2D5D04DBE4E8D4850BEC46',
  hash: 'AC0E6CD586B7CFF8D0431ABCB0BC5A05BA8FC61317A22D00C673A53C672BB694',
  metaData: [Object] },

{ Account: 'rEqSQFMsmMmhx8tGqmSEhXZ8KjBdkW6Qbc',
  Amount: '20000000000',
  Destination: 'rhbaHwBJCm1vxvEtR3iPWhHb99D4tjMqkM',
  Fee: '12',
  Flags: 0,
  Sequence: 7,
  SigningPubKey: '02CEAD9CD2AD131F309A4C1CB6FE3690C2719A20DD96E2EC7E3F831C2781650431',
  TransactionType: 'Payment',
  TxnSignature: '30450220741AF7C1C8702F0A8CB73A3609F5ECAE5DDECBC99BE713D6770C6896134003830221008C829277C4AC143CA810B1762261FD88E2C3B0D787BD086A43C4962658A0094F',
  hash: 'C72A05BD8124CDDB0288C556EA466B278F77A6BBC35EEAF29F536A83FE4CD5D6',
  metaData: [Object] },

{ Account: 'rf9q1WE2Kdmv9AWtesCaANJyNxnFjp5T7z',
  Amount: [Object],
  Destination: 'rf9q1WE2Kdmv9AWtesCaANJyNxnFjp5T7z',
  Fee: '15',
  Flags: 0,
  Paths: [Object],
  SendMax: '9988719',
  Sequence: 21461,
  SigningPubKey: '02536B8C6323A2A079A785E85FAFE087F46499C7ADEF2E211B332BF377629F3042',
  TransactionType: 'Payment',
  TxnSignature: '3045022079FC6B5FDB0DDCB6DC32F15B34E58EB74D532801891F80893ADD979D40DD6F3F022100962EA7C10FCA31BD75859F702A09D60374A8A5C09A8AF9A22CD6032FFE08E761',
  hash: 'E90F82989A6A6F7E3C778B76C73486687C708658FCD98B6C82CC23691535F5CB',
  metaData: [Object] },
*/

